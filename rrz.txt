Here are the updated files. I have implemented the **Participant Removed Subscription**, fixed the **Ticket/Conversation Subscription visibility**, and applied the **5 distinct visual styles** for the cards and window headers.

### 1. `graphql/resolvers/messagingResolver.ts`
**Changes:**
- Updated `communicationItemAdded` subscription filter to ensure users only receive events for items they are part of (Fixes the Ticket visibility issue).
- Added `participantRemoved` subscription logic.
- Updated `removeParticipant` mutation to publish the removal event.

```typescript

```

### 2. `graphql/subscriptions/messagingSubscription.ts`
**Changes:** Added `PARTICIPANT_REMOVED_SUBSCRIPTION`.

```typescript

```

### 3. `hooks/useMessaging.ts`
**Changes:**
- Consumed `PARTICIPANT_REMOVED_SUBSCRIPTION`.
- Logic to immediately refresh chat details if the current user is the one kicked, updating the UI state (input disabling) instantly.

```typescript

```

### 4. `components/messaging/conversation-list.tsx`
**Changes:** GOAL 3: Implemented 5 distinct card styles (Direct, Group, Ticket Low/Med/High).

```typescript

```

### 5. `components/messaging/communication-window.tsx`
**Changes:** GOAL 3: Visual design applied to Window Header (bg colors) matching list items.

```typescript

```
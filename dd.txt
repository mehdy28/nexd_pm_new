"use client";

import "@blocknote/core/fonts/inter.css";
import { useCreateBlockNote } from "@blocknote/react";
import { BlockNoteView } from "@blocknote/shadcn";
import "@blocknote/shadcn/style.css";

import { generateContentBlock } from "@/ai/flows/ai-assisted-content-creation";
import { suggestTextImprovements } from "@/ai/flows/ai-suggest-text-improvements";

// Imports for custom ShadCN components
import * as Badge from "@/components/ui/badge";
import * as Button from "@/components/ui/button";
import * as Card from "@/components/ui/card";
import * as DropdownMenu from "@/components/ui/dropdown-menu";
import * as Form from "@/components/ui/form";
import * as Input from "@/components/ui/input";
import * as Label from "@/components/ui/label";
import * as Popover from "@/components/ui/popover";
import * as Select from "@/components/ui/select";
import * as Tabs from "@/components/ui/tabs";
import * as Toggle from "@/components/ui/toggle";
import * as Tooltip from "@/components/ui/tooltip";
import {
  bugReportTemplate,
  meetingNotesTemplate,
  productRoadmapTemplate,
  projectBriefTemplate,
  projectKickoffTemplate,
  projectStatusReportTemplate,
  retrospectiveTemplate,
  riskRegisterTemplate,
  sprintPlanningTemplate,
  taskListTemplate,
} from "./templates";

const shadCNComponents = {
  Badge,
  Button,
  Card,
  DropdownMenu,
  Form,
  Input,
  Label,
  Popover,
  Select,
  Tabs,
  Toggle,
  Tooltip,
};

export default function Editor() {
  const editor = useCreateBlockNote({
    ai: {
      generateContent: async (prompt) => {
        const { content } = await generateContentBlock({ prompt });
        return content;
      },
      improveText: async (text) => {
        const { improvedText } = await suggestTextImprovements({ text });
        return improvedText;
      },
    },
    // You can swap `meetingNotesTemplate` with any other imported template
    // e.g., projectBriefTemplate, bugReportTemplate, projectStatusReportTemplate, etc.
    initialContent: meetingNotesTemplate,
  });

  return (
    <BlockNoteView
      editor={editor}
      shadCNComponents={shadCNComponents}
      theme={"light"}
    />
  );
}
